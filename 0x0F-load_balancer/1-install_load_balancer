#!/usr/bin/env bash
# Install and configure HAproxy on your lb-01 server.
sudo apt update
sudo apt-get install --no-install-recommends software-properties-common -y
sudo add-apt-repository ppa:vbernat/haproxy-2.8 -y
sudo apt-get install haproxy=2.8.\* -y
sudo cp -a /etc/haproxy/haproxy.cfg{,.orig}

sudo echo 'frontend bouhvli.tech
    bind *:80
    default_backend backservers

backend backservers
    balance roundrobin
    server 291203-web-01 100.24.255.23:80 check
    server 291203-web-02 54.234.80.214:80 check"
' >> /etc/haproxy/haproxy.cfg
sudo service haproxy start